## Сервис авторизации по номеру телефона.

### Цель проекта — обеспечить простой и надежный механизм авторизации и реферальной системы, который можно будет легкотестировать и интегрировать в другие системы.

### API приложение для авторизации с помощью телефона. Приложение выполнено на фреймворке Django и Django REST framework. PostgreSQL используется для сохранения данных.

## Использование c помощью **Docker**

* github - https://github.com/AlexTalko/auth_phone.git
* В виртуальном окружении установите **requirements.txt** (пакет с зависимостями) с помощью команды:

```sh
$ pip install -r requirements.txt
```

* Добавьте в свой проект файл **.env** c необходимыми для работы паролями.
  Пример **.env.sample** размещен в проекте.
* Запустите терминал и выполните команды:

```sh
$ docker-compose up -d --build
```

* Если требуется доступ к админке, выполните команду:
  (Супер пользователь ***phone='72223334455'*** ***password='123456'***)

```sh
$ docker-compose exec app python manage.py csu 
```

или в терминале редактора исходного кода

```sh
$ python manage.py csu 
```

## Разработка

### В данном проекте реализовано два приложения:

`users_interface` - интерфейс на Django Templates для базового тестирования функционала. /
`users` - API представление

## users:

Модель **User** - реализована с полями:

* *phone*
* *first_name*
* *last_name*
* *country*
* *invite_code* - код пользователя для приглашения других
* *ref_code* - реферальный код, пользователь ввел себе лично

#### Настроены контроллеры:

* для создания пользователя
* для получения данных пользователя
* для редактирования данных

#### Настроена административная панель

* Сортировка по полям:
*
    * id
*
    * phone
*
    * country
*
    * ref_code
* Поиск по полям:
*
    * phone
*
    * first_name
*
    * last_name
*
    * country

### Реализованы сервисные функции:

* generate_code - Функция создает случайную комбинацию букв и цифр
* create_invite_code - Функция проверяет созданный с помощью *generate_code* на наличие в базе данных
* send - Функция отправляет созданный код в смс на заданный телефон пользователем, для авторизации в сервисе

### Реализован валидатор номера телефона

* Введенный пользователем номер телефона, проверяется *phone_validator* на количество символов и корректность

## users_interface:

* Согласно условиям проекта реализован минимальный интерфейс с помощью **Django Templates**
  для тестирования функционала.

## Реализована отправка кода для авторизации, в sms по номеру пользователя, с помощью сервиса *SmsAero*

* Документация https://smsaero.ru/integration/documentation/api/
* Для взаимодействия с сервисом необходимо

    * Регистрация https://smsaero.ru/integration/class/python/
    * Добавить в файл .env *SMSAERO_EMAIL* - логин
    * Добавить в файл .env *SMSAERO_API_KEY* - API ключ из личного кабинета SmsAero
    * Установить модуль SmsAero c помощью **pip install -U smsaero-api** ***(если не установилось из requirements.txt)***
* Отправку sms осуществляет функция **/services/send**

## Реализовано тестирование для всех основных функций платформы.

* Запуск тестирования

```sh
$ coverage run --source=users manage.py test users
```

* Отображения статистики покрытия

```sh
$ coverage report
```

## Технические требования

1. **Язык программирования:**
    - Python 3.11+
2. **Фреймворк:**
    - Django для реализации REST API с использованием Django REST Framework (DRF)
3. **База данных:**
    - PostgreSQL для хранения данных
4. **ORM:**
    - Django ORM для взаимодействия с базой данных
5. **Контейнеризация:**
    - Docker для контейнеризации приложения
6. **Документация:**
    - В корне проекта размещен файл README.md с описанием структуры проекта, инструкциями по установке и запуску, а
      также описанием API.
7. **Качество кода:**
    - Соблюдены стандарты PEP8 для Python кода.
    - Весь код должен храниться в удаленном Git репозитории.
8. **Автодокументация:**
    - Реализована автогенерируемая документация API с использованием Swagger и/или ReDoc.
9. **Тестирование**
    - Написать тесты для всех основных функций платформы.
    - Покрытие тестами должно быть минимум 75%.